<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Doctor</title>
    <style>
        /* General Styles */
        body {
          font-family: "Poppins", sans-serif;
          margin: 0;
          padding: 0;
          background: linear-gradient(
            to bottom,
            #e3f2fd,
            #bbdefb
          ); /* Soft blue gradient */
          color: #333;
          overflow-x: hidden;
          animation: fadeIn 1s ease-in-out;
        }
  
        /* Container Styling */
        .container {
          width: 40%;
          margin: 40px auto;
          background: #ffffff;
          padding: 25px;
          border-radius: 12px;
          box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
          animation: slideIn 1s ease-out;
        }
  
        .container:hover {
          box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
        }
  
        h1 {
          text-align: center;
          color: #0056b3; /* Dark Blue */
          font-size: 30px;
          margin-bottom: 20px;
          animation: popUp 0.8s ease-in-out;
        }
  
        /* Form Styling */
        form {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }
  
        label {
          font-size: 14px;
          color: #333; /* Neutral Dark */
          font-weight: bold;
          margin-bottom: 8px;
          opacity: 0;
          animation: fadeInLeft 0.6s ease forwards;
        }
  
        @keyframes fadeInLeft {
          from {
            opacity: 0;
            transform: translateX(-30px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }
  
        input[type="text"],
        input[type="email"],
        input[type="number"],
        input[type="date"],
        
        select {
          width: 100%;
          padding: 12px;
          font-size: 14px;
          border: 1px solid #ddd;
          border-radius: 6px;
          box-sizing: border-box;
          transition: border 0.3s, box-shadow 0.3s, transform 0.3s;
        }
        input[type="password"]{
            width: 60%;
            padding: 12px;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            transition: border 0.3s, box-shadow 0.3s, transform 0.3s;
        }
        input:focus,
        select:focus {
          border-color: #0056b3;
          box-shadow: 0 0 10px rgba(0, 86, 179, 0.4);
          transform: scale(1.02);
          outline: none;
        }
  
        input[type="checkbox"] {
          margin-right: 10px;
        }
  
        /* Buttons */
        button {
          padding: 12px;
          font-size: 16px;
          color: #fff;
          background: linear-gradient(
            to right,
            #42a5f5,
            #007bff
          ); /* Blue gradient */
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.3s, transform 0.3s ease, box-shadow 0.3s;
        }
  
        button:hover {
          background: linear-gradient(to right, #1e88e5, #0056b3);
          transform: scale(1.05);
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
  
        /* Back Button */
        .back-button {
          display: inline-block;
          margin-bottom: 20px;
          padding: 10px 15px;
          background: linear-gradient(
            to right,
            #64b5f6,
            #42a5f5
          ); /* Light blue gradient */
          color: white;
          border: none;
          border-radius: 6px;
          text-decoration: none;
          font-size: 14px;
          transition: background 0.3s, transform 0.2s ease;
          animation: fadeInLeft 0.8s ease-in-out;
        }
  
        .back-button:hover {
          background: linear-gradient(to right, #42a5f5, #1e88e5);
          transform: scale(1.05);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
  
        /* Messages */
        .success-message {
          background-color: #d4edda;
          color: #155724;
          padding: 12px;
          border: 1px solid #c3e6cb;
          border-radius: 6px;
          font-size: 14px;
          animation: fadeIn 0.5s ease-in-out;
        }
  
        .error-message {
          background-color: #f8d7da;
          color: #721c24;
          padding: 12px;
          border: 1px solid #f5c6cb;
          border-radius: 6px;
          font-size: 14px;
          animation: fadeIn 0.5s ease-in-out;
        }
  
        .error-text {
          color: #e3342f;
          font-size: 13px;
          margin-top: 5px;
        }
  
        .form-actions {
          text-align: center;
        }
  
        /* Animations */
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateY(50px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        @keyframes fadeInDown {
          from {
            opacity: 0;
            transform: translateY(-50px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        @keyframes popUp {
          from {
            transform: scale(0.8);
            opacity: 0;
          }
          to {
            transform: scale(1);
            opacity: 1;
          }
        }
      </style>
    <script>
        // Function to fetch doctor details
        async function fetchDoctorDetails(doctorId) {
            try {
                const url = `http://localhost:8082/doctor/${doctorId}`;
                console.log("Fetching from URL:", url); // Log the URL
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error("Failed to fetch doctor details");
                }
                const doctor = await response.json();
                populateDoctorForm(doctor);
            } catch (error) {
                console.error(error);
                alert("Error fetching doctor details");
            }
        }

        // Function to populate the form fields with fetched doctor details
        function populateDoctorForm(doctor) {
            document.getElementById("doctorId").value = doctor.doctorId;
            document.getElementById("doctorName").value = doctor.doctorName;
            document.getElementById("specialization").value = doctor.specialization;
            document.getElementById("qualification").value = doctor.qualification;
            document.getElementById("consultationFees").value = doctor.consultationFees;
            document.getElementById("contactNumber").value = doctor.contactNumber;
            document.getElementById("emailId").value = doctor.emailId;
            document.getElementById("location").value = doctor.location;
            document.getElementById("dateOfJoining").value = doctor.dateOfJoining;
            document.getElementById("yearsOfExperience").value = doctor.yearsOfExperience;
			document.getElementById("username").value = doctor.username;
			document.getElementById("password").value = doctor.password;
            document.getElementById("status").checked = doctor.status;
            document.getElementById("surgeon").checked = doctor.surgeon;
            document.getElementById("gender").value = doctor.gender;
        }

        // Function to update doctor details via PUT request
        async function updateDoctorDetails(event) {
            event.preventDefault(); // Prevent the form from submitting in the default way

            const doctorId = document.getElementById("doctorId").value;
            const updatedDoctor = {
                doctorId: doctorId,
                doctorName: document.getElementById("doctorName").value,
                specialization: document.getElementById("specialization").value,
                qualification: document.getElementById("qualification").value,
                contactNumber: document.getElementById("contactNumber").value,
                emailId: document.getElementById("emailId").value,
                location: document.getElementById("location").value,
                dateOfJoining: document.getElementById("dateOfJoining").value,
                yearsOfExperience: document.getElementById("yearsOfExperience").value,
				username:  document.getElementById("username").value,
				password:  document.getElementById("password").value,
                status: document.getElementById("status").checked,
                surgeon: document.getElementById("surgeon").checked,
                gender: document.getElementById("gender").value,
                consultationFees: document.getElementById("consultationFees").value
            };

            try {
                const response = await fetch(`http://localhost:8082/doctor/${doctorId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedDoctor),
                });

                if (!response.ok) {
                    throw new Error("Failed to update doctor details");
                }

                const updatedDoctorDetails = await response.json();
                alert("Doctor details updated successfully");
                console.log(updatedDoctorDetails); // Log the updated doctor details if needed
            } catch (error) {
                console.error(error);
                alert("Error updating doctor details");
            }
        }

        // Execute when the page loads
        document.addEventListener("DOMContentLoaded", () => {
            const doctorId = document.getElementById("doctorIdHidden").value;
            fetchDoctorDetails(doctorId);

            // Attach submit handler to the form
            document.getElementById("editDoctorForm").addEventListener("submit", updateDoctorDetails);
        });
		function togglePasswordVisibility() {
		           const passwordInput = document.getElementById("password");
		           const toggleButton = document.getElementById("togglePassword");
		           if (passwordInput.type === "password") {
		               passwordInput.type = "text";
		               toggleButton.textContent = "Hide";
		           } else {
		               passwordInput.type = "password";
		               toggleButton.textContent = "Show";
		           }
		       }
    </script>
	<script>
	    function goBack() {
	        const doctorId = document.getElementById("doctorIdHidden").value;
	        window.location.href = `http://localhost:9093/doctorHomePage/${doctorId}`;
	    }
	</script>
</head>
<body>
<div class="container">
    <h1>Edit Doctor</h1>
    <!-- Hidden input to pass the doctor ID -->
    <input type="hidden" id="doctorIdHidden" th:value="${doctorId}">

    <form id="editDoctorForm">
        <div class="input-group">
            <label for="doctorId">Doctor ID:</label>
            <input type="number" id="doctorId" readonly><br>
        </div>

        <div class="input-group">
            <label for="doctorName">Doctor Name:</label>
            <input type="text" id="doctorName" placeholder="Enter Doctor Name"><br>
        </div>

		
        <div class="input-group">
            <label for="specialization">Specialization:</label>
            <input type="text" id="specialization" readonly placeholder="Enter Specialization"><br>
        </div>
		

        <div class="input-group">
            <label for="qualification">Qualification:</label>
            <input type="text" id="qualification" readonly placeholder="Enter Qualification"><br>
        </div>

        <div class="input-group">
            <label for="consultationFees">Consultation Fees:</label>
            <input type="number" id="consultationFees" readonly placeholder="Enter Consultation Fees"><br>
        </div>
		

        <div class="input-group">
            <label for="contactNumber">Contact Number:</label>
            <input type="text" id="contactNumber" placeholder="Enter Contact Number"><br>
        </div>

        <div class="input-group">
            <label for="emailId">Email ID:</label>
            <input type="email" id="emailId" placeholder="Enter Email ID"><br>
        </div>

        <div class="input-group">
            <label for="location">Location:</label>
            <input type="text" id="location" placeholder="Enter Location"><br>
        </div>
       
        <div class="input-group">
            <label for="dateOfJoining">Date of Joining:</label>
            <input type="date" id="dateOfJoining" readonly><br>
        </div>

        <div class="input-group">
            <label for="yearsOfExperience">Years of Experience:</label>
            <input type="number" id="yearsOfExperience" readonly placeholder="Enter Years of Experience"><br>
        </div>
		


        <div class="input-group">
            <label for="username">username:</label>
            <input type="text" id="username" readonly placeholder="Enter username"><br>
        </div>

		<label for="password">Password:</label>
		       <div class="password-group">
		           <input type="password" id="password">
		           <button type="button" id="togglePassword" class="password-toggle" onclick="togglePasswordVisibility()">Show</button>
		       </div>


        <div class="status-checkbox">
            <label for="status">Status:</label>
            <input type="checkbox" id="status"readonly ><br>
        </div>

        <div class="surgeon-checkbox">
            <label for="surgeon">Surgeon:</label>
            <input type="checkbox" id="surgeon" readonly><br>
        </div>
		
		

        <div class="input-group">
            <label for="gender">Gender:</label>
            <select id="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select><br>
        </div>
		<div style="text-align: left; margin-bottom: 10px;">
		    <button type="button" onclick="goBack()" class="btn btn-secondary">Back</button>
		</div>


        <button type="submit">Save</button>
    </form>
</div>
</body>
</html>
